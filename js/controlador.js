///-----------------------------------------------USUARIOS
var usuarios = [
    {
        nombre:"Pedro",
        apellido:"Martinez",
        ordenes:[
            {
                nombreProducto:"Producto 1",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad:2,
                precio:19.99
            },
            {
                nombreProducto:"Producto 2",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad:2,
                precio:29.99
            }
        ]
    },
    {
        nombre:"Juan",
        apellido:"Perez",
        ordenes:[
            {
                nombreProducto:"Producto 3",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad:2,
                precio:39.99
            },
            {
                nombreProducto:"Producto 4",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad:2,
                precio:49.99
            }
        ]
    },
    {
        nombre:"Maria",
        apellido:"Rodriguez",
        ordenes:[
            {
                nombreProducto:"Producto 5",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad:2,
                precio:59.99
            },
            {
                nombreProducto:"Producto 6",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad:2,
                precio:69.99
            }
        ]
    }
];


///-----------------------------------------------CATEGORIAS
var categorias = [
    {
        nombreCategoria:"Farmacias",
        descripcion:"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color:"#fadb54",
        icono:"fa-solid fa-briefcase-medical",
        empresas:[
            {
                nombreEmpresa: "Farmacia 1",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1 F1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2 F1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3 F1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4 F1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria:"Restaurantes",
        descripcion:"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color:"#f3adac",
        icono:"fa-solid fa-utensils",
        empresas:[
            {
                nombreEmpresa: "Restaurante 1",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1 R1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2 R1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3 R1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4 R1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria:"Salud",
        descripcion:"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color:"#d98f6d",
        icono:"fa-solid fa-heart-pulse",
        empresas:[
            {
                nombreEmpresa: "Salud 1",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1 S1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2 S1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3 S1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4 S1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria:"Café",
        descripcion:"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color:"#9482c4",
        icono:"fa-solid fa-mug-hot",
        empresas:[
            {
                nombreEmpresa: "Café 1",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1 C1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2 C1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3 C1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4 C1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria:"Bebidas",
        descripcion:"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color:"#f3ac85",
        icono:"fa-solid fa-champagne-glasses",
        empresas:[
            {
                nombreEmpresa: "Bebidas 1",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1 B1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2 B1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3 B1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4 B1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    }
];

// console.log ('Usuarios', usuarios);
// console.log ('Categorias', categorias);






window.onload = function(){ 
    // obtenerCategorias();
    obtenerUsuarios();
    alert("Ing. tuve que modificar algunos REGISTOS del JSON, NO TOQUE SU ESTRUCTURA, fue para verificar que los registros que obtenia eran los correctos");
}

// limpiamos el localStorage
localStorage.clear();

// verificar si ya estan almacenadas en el localStorage
if (localStorage.getItem('usuarios') === null) {
    localStorage.setItem('usuarios', JSON.stringify(usuarios));
}

if (localStorage.getItem('categorias') === null) {
    localStorage.setItem('categorias', JSON.stringify(categorias));
}

// Obtener categorias del localStorage
function obtenerCategorias(){
    let categoriasLS = JSON.parse(localStorage.getItem('categorias'));
    imprimirCategorias(categoriasLS);
    // console.log(categoriasLS);
}

// imprimir categorias
function imprimirCategorias(categoriasLS) {
    let html = '';
    categoriasLS.forEach(categoria => {
        html += 
        `
        <div class="descripcion-miniatura" style="background-color: ${categoria.color};" onclick="getProductos('${categoria.nombreCategoria}');" data-bs-toggle="modal" data-bs-target="#modal-empresas">
                <div class="borde-icono">
                    <i class="${categoria.icono}"></i>
                </div>
                <div class="card-body">
                    <h5 class="card-title">${categoria.nombreCategoria}</h5>
                    <h6 class="card-text">${categoria.empresas.length} Comercios</h6>
                </div>
        </div>
        `;
    });
    document.getElementById('categorias').innerHTML = html; 
}

// Obtenemos los usuarios del localStorage
function obtenerUsuarios(){
    let usuariosLS = JSON.parse(localStorage.getItem('usuarios'));
    // console.log (usuariosLS);
    addUsuario(usuariosLS);
}

// imprimir usuarios
function addUsuario(usuariosLS){
    usuariosLS.forEach(usuario => {
        const selectElement = document.getElementById('usuarioActual');
        selectElement.insertAdjacentHTML('beforeend', `<option>${usuario.nombre} ${usuario.apellido}</option>` );
    });
}

// Carbiar usuario actual
function cambiarUsuario (){
    // console.log("Usuario: "+ document.getElementById("usuarioActual").value);
    let actual = document.getElementById("usuarioActual").value;
    let name = actual.split(' ')[0];

    const selectElement = document.getElementById('inicio');
    selectElement.innerHTML = ' ';
    selectElement.insertAdjacentHTML('beforeend', `
        <h1 class="saludo">Hola ${name}!</h1>
        <h2>¿Que necesitas?</h2><br>
    ` );
    obtenerCategorias();

}

// obtener ordenes de usuario espefico del localStorage
function getUser(){
    $("#pedidos-modal").html('');
    let actual = document.getElementById("usuarioActual").value;
    let name = actual.split(' ')[0];
    // console.log("nombre del select: ",name);

    if (name === "Usuario") {
        alert("Error: Selecciona un usuario");
    }else{
        // Agrego titulo al modal
        $("#modal-titulo").html('');
        $("#modal-titulo").append(
            `<h3 class="modal-title" id="exampleModalLabel">${name}, estas son tus Ordenes</h3>`
        );

        // Agrego propiedades al boton "ordenes" para que se abra el modal
        var boton = document.getElementById("btn-ordenes");
        boton.setAttribute("data-bs-toggle", "modal");
        boton.setAttribute("data-bs-target", "#modal-ordenes");

        // Obtenemos el usuario especifico del localStorage
        let getUser = JSON.parse(localStorage.getItem('usuarios'));

        // busco el usuario especifico
        for (let i = 0; i < getUser.length; i++) {
            if (getUser[i].nombre === name) {
                // console.log (getUser[i],"getUser[i]");

                // Obtenemos las ordenes del usuario
                buscar = getUser[i].ordenes;
                for (let x = 0; x < buscar.length; x++) {
                    $("#pedidos-modal").append(
                        `<p class="n-producto">${buscar[x].nombreProducto}</p>
                        <p class="n-descripcion">${buscar[x].descripcion}</p>
                        <p class="n-precio">$${buscar[x].precio}</p>
                        <hr>`
                    );
                }
            }
        }
    }
}

// Obtener producotos segun categoria
function getProductos(categoria){
    $("#empresas-modal").html('');
    // console.log("nombre del parametro: ",categoria);

    $("#titulo-categoria").html('');
    $("#titulo-categoria").append(
        `<h3 class="modal-title" id="exampleModalLabel">${categoria}</h3>`
    );

    // Obtenemos el usuario especifico del localStorage
    let getCategoria = JSON.parse(localStorage.getItem('categorias'));

    // recorro todas las categorias
    for (let i = 0; i < getCategoria.length; i++) { 

        // si la categoria es igual a la categoria que selecciono el usuario 
        if (getCategoria[i].nombreCategoria === categoria) {
            // console.log ("getCategoria[i]:", getCategoria[i]);

            buscar = getCategoria[i].empresas;

            // Obtenemos las empresas de la categoria
            for (let x = 0; x < buscar.length; x++) {

                var pro = '';
                for (let i = 0; i < buscar.length; i++) {
                // console.log(buscar[x].productos[i]);

                // recorro todos los productos de la empresa
                pro+= `
                <div class="product-pre">
                    <p class="n-producto">${buscar[x].productos[i].nombreProducto}</p>
                    <button class="btn btn-primary btn-sm btn-pedir" data-bs-toggle="modal" data-bs-target="#modal-cantidad" onclick="proOrde('${buscar[x].productos[i].nombreProducto}', '${buscar[x].productos[i].descripcion}', '${buscar[x].productos[i].precio}');">Pedir</button>
                </div>
                    <p class="n-descripcion">${buscar[x].productos[i].descripcion}</p>
                    <p class="n-precio">$${buscar[x].productos[i].precio}</p>
                    <hr>
                `;
            }

            $("#empresas-modal").append(
                `<div class="empresa">
                    <div class="div-fondo" >
                        ${buscar[x].nombreEmpresa}
                    </div>
                    <div class="productos" id="${buscar[x].nombreEmpresa}">
                            ${pro}
                    </div>
                </div>`
                );
            }
        }
    }
}

// informacion para el modal de cantidad a solicitar
function proOrde(nproducto, ndescripcion, nprecio){
    $("#orden").html('');
    $("#orden").append(`
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        <p class="n-producto">${nproducto}</p>
        <p class="n-descripcion">${ndescripcion}</p>
        <div class="div-input">
            <p class="n-descripcion">Cantidad a solicitar:</p>
            <input id="input" type="number">
        </div>
        <p class="n-precio">$${nprecio}</p>
    `);
}

